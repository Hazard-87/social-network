{"ast":null,"code":"import _regeneratorRuntime from\"/media/hazard/\\u041B\\u043E\\u043A\\u0430\\u043B\\u044C\\u043D\\u044B\\u0439 \\u0434\\u0438\\u0441\\u043A/react/project/react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/media/hazard/\\u041B\\u043E\\u043A\\u0430\\u043B\\u044C\\u043D\\u044B\\u0439 \\u0434\\u0438\\u0441\\u043A/react/project/react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/media/hazard/\\u041B\\u043E\\u043A\\u0430\\u043B\\u044C\\u043D\\u044B\\u0439 \\u0434\\u0438\\u0441\\u043A/react/project/react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/media/hazard/\\u041B\\u043E\\u043A\\u0430\\u043B\\u044C\\u043D\\u044B\\u0439 \\u0434\\u0438\\u0441\\u043A/react/project/react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../api/api\";var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_MORE_USERS='SET_MORE_USERS';var SET_СURRENT_PAGE='SET_СURRENT_PAGE';var SET_TOTAL_PAGE_COUNT='SET_TOTAL_PAGE_COUNT';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='TOGGLE_IS_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:8,totalPageCount:0,currentPage:1,isFetching:true,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userId){return _objectSpread(_objectSpread({},u),{},{followed:true});}return u;})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userId){return _objectSpread(_objectSpread({},u),{},{followed:false});}return u;})});case SET_USERS:{return _objectSpread(_objectSpread({},state),{},{users:action.users});}case SET_MORE_USERS:{var users=state.users.concat(action.users);return _objectSpread(_objectSpread({},state),{},{users:users});}case SET_СURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});}case SET_TOTAL_PAGE_COUNT:{return _objectSpread(_objectSpread({},state),{},{totalPageCount:action.totalPageCount});}case TOGGLE_IS_FETCHING:{return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});}case TOGGLE_IS_FOLLOWING_PROGRESS:{return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!=action.userId;})});}default:return state;}};export var requestUsers=function requestUsers(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));_context.next=3;return usersAPI.getUsers(currentPage,pageSize);case 3:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalPageCount(data.totalCount));case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var requestMoreUsers=function requestMoreUsers(nextPage,pageSize){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleIsFetching(true));_context2.next=3;return usersAPI.getUsers(nextPage,pageSize);case 3:data=_context2.sent;dispatch(toggleIsFetching(false));dispatch(setMoreUsers(data.items));dispatch(setTotalPageCount(data.totalCount));case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context3.next=3;return usersAPI.getFollow(userId);case 3:data=_context3.sent;if(data.resultCode==0){dispatch(followAccept(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context4.next=3;return usersAPI.getUnfollow(userId);case 3:data=_context4.sent;if(data.resultCode==0){dispatch(unfollowAccept(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var followAccept=function followAccept(userId){return{type:'FOLLOW',userId:userId};};export var unfollowAccept=function unfollowAccept(userId){return{type:'UNFOLLOW',userId:userId};};export var setUsers=function setUsers(users){return{type:'SET_USERS',users:users};};export var setMoreUsers=function setMoreUsers(users){return{type:'SET_MORE_USERS',users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:'SET_СURRENT_PAGE',currentPage:currentPage};};export var setTotalPageCount=function setTotalPageCount(totalPageCount){return{type:'SET_TOTAL_PAGE_COUNT',totalPageCount:totalPageCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:'TOGGLE_IS_FETCHING',isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:'TOGGLE_IS_FOLLOWING_PROGRESS',isFetching:isFetching,userId:userId};};export default usersReducer;","map":{"version":3,"sources":["/media/hazard/Локальный диск/react/project/react-deploy/src/redux/usersReducer.js"],"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_MORE_USERS","SET_СURRENT_PAGE","SET_TOTAL_PAGE_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalPageCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","map","u","id","userId","followed","concat","filter","requestUsers","dispatch","toggleIsFetching","getUsers","data","setUsers","items","setTotalPageCount","totalCount","requestMoreUsers","nextPage","setMoreUsers","follow","toggleFollowingProgress","getFollow","resultCode","followAccept","unfollow","getUnfollow","unfollowAccept","setCurrentPage"],"mappings":"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","sourcesContent":["import {usersAPI} from \"../api/api\";\n\nconst FOLLOW = 'FOLLOW'\nconst UNFOLLOW = 'UNFOLLOW'\nconst SET_USERS = 'SET_USERS'\nconst SET_MORE_USERS = 'SET_MORE_USERS'\nconst SET_СURRENT_PAGE = 'SET_СURRENT_PAGE'\nconst SET_TOTAL_PAGE_COUNT = 'SET_TOTAL_PAGE_COUNT'\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING'\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE_IS_FOLLOWING_PROGRESS'\nlet initialState = {\n    users: [],\n    pageSize: 8,\n    totalPageCount: 0,\n    currentPage: 1,\n    isFetching: true,\n    followingInProgress: []\n}\n\nconst usersReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case FOLLOW :\n            return {\n                ...state,\n                users: state.users.map(u => {\n                    if (u.id === action.userId) {\n                        return {...u, followed: true}\n                    }\n                    return u\n                })\n            }\n\n        case UNFOLLOW :\n            return {\n                ...state,\n                users: state.users.map(u => {\n                    if (u.id === action.userId) {\n                        return {...u, followed: false}\n                    }\n                    return u\n                })\n            }\n        case SET_USERS: {\n            return {...state, users: action.users}\n        }\n        case SET_MORE_USERS: {\n            let users = state.users.concat(action.users)\n            return {...state, users: users}\n        }\n        case SET_СURRENT_PAGE: {\n            return {...state, currentPage: action.currentPage}\n        }\n        case SET_TOTAL_PAGE_COUNT: {\n            return {...state, totalPageCount: action.totalPageCount}\n        }\n        case TOGGLE_IS_FETCHING: {\n            return {...state, isFetching: action.isFetching}\n        }\n        case TOGGLE_IS_FOLLOWING_PROGRESS: {\n            return {\n                ...state,\n                followingInProgress: action.isFetching\n                    ? [...state.followingInProgress, action.userId]\n                    : state.followingInProgress.filter(id => id != action.userId)\n            }\n        }\n        default:\n            return state;\n    }\n}\n\nexport const requestUsers = (currentPage, pageSize) => {\n    return async (dispatch) => {\n        dispatch(toggleIsFetching(true))\n        let data = await usersAPI.getUsers(currentPage, pageSize)\n        dispatch(toggleIsFetching(false))\n        dispatch(setUsers(data.items))\n        dispatch(setTotalPageCount(data.totalCount))\n    }\n}\n\nexport const requestMoreUsers = (nextPage, pageSize) => {\n    return async (dispatch) => {\n        dispatch(toggleIsFetching(true))\n        let data = await usersAPI.getUsers(nextPage, pageSize)\n        dispatch(toggleIsFetching(false))\n        dispatch(setMoreUsers(data.items))\n        dispatch(setTotalPageCount(data.totalCount))\n    }\n}\n\nexport const follow = (userId) => {\n    return async (dispatch) => {\n        dispatch(toggleFollowingProgress(true, userId))\n        let data = await usersAPI.getFollow(userId)\n        if (data.resultCode == 0) {\n            dispatch(followAccept(userId))\n        }\n        dispatch(toggleFollowingProgress(false, userId))\n    }\n}\n\nexport const unfollow = (userId) => {\n    return async (dispatch) => {\n        dispatch(toggleFollowingProgress(true, userId))\n       let data = await usersAPI.getUnfollow(userId)\n            if (data.resultCode == 0) {\n                dispatch(unfollowAccept(userId))\n            }\n            dispatch(toggleFollowingProgress(false, userId))\n    }\n}\n\nexport const followAccept = (userId) => ({type: 'FOLLOW', userId})\nexport const unfollowAccept = (userId) => ({type: 'UNFOLLOW', userId})\nexport const setUsers = (users) => ({type: 'SET_USERS', users})\nexport const setMoreUsers = (users) => ({type: 'SET_MORE_USERS', users})\nexport const setCurrentPage = (currentPage) => ({type: 'SET_СURRENT_PAGE', currentPage})\nexport const setTotalPageCount = (totalPageCount) => ({type: 'SET_TOTAL_PAGE_COUNT', totalPageCount})\nexport const toggleIsFetching = (isFetching) => ({type: 'TOGGLE_IS_FETCHING', isFetching})\nexport const toggleFollowingProgress = (isFetching, userId) => ({\n    type: 'TOGGLE_IS_FOLLOWING_PROGRESS',\n    isFetching,\n    userId\n})\nexport default usersReducer;"]},"metadata":{},"sourceType":"module"}